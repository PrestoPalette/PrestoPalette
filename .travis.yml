language: cpp

dist: trusty

sudo: required

compiler:
  - g++
#  - clang

os:
  - linux
#  - osx

env:
  matrix:
    - FLAGS="-DCMAKE_BUILD_TYPE=Debug"
#    - FLAGS="-DCMAKE_BUILD_TYPE=Release"

before_install:
 - sudo add-apt-repository --yes ppa:beineri/opt-qt58-trusty
 - sudo apt-get update -qq
 
install:
 - sudo apt-get install -qq cmake qt58base
 - sudo apt-get -qy install pngcrush qttools5-dev
 - sudo apt-get -qy install qt5-default qt5-qmake qtbase5-dev libqt5xmlpatterns5-dev qtmultimedia5-dev

script:
  - source /opt/qt58/bin/qt58-env.sh
  - /opt/qt58/bin/qmake PREFIX=/usr
  - /opt/qt58/bin/qmake --version
  - qmake --version
  - mkdir build
  - cd build
  - cmake -trace --warn-uninitialized --warn-unused_vars -Wdev -G "Unix Makefiles" .. -DCMAKE_INSTALL_PREFIX=../install $FLAGS
  - make && ctest && make install && cpack -G "TGZ"

addons:
  apt:
    packages:
    - cmake
    - cmake-data
